---
title: "class05"
author: "Chen"
format: pdf
toc: true
---


## Background

There are lots of ways to make plots in R. These include so-called "base R" (like the `plot()`) and on packages like **ggplot2**.


Let's make the sampe plot with these two graphics systems. We can use the inbuilt `cars` dataset:

shortcut: option+command+i(insert)
```{r}
head(cars)
```



With "base R" we can simply
```{r}
plot(cars)
```

Now let's try ggplot. First I need to install the package using `install.packages("ggplot2")`.

> **N.B.** We never run an `install.packages()` in a code chunl otherwise we  will reinstall needlessly every time we render the document.

Every time we want to use an add=on package we need to load it up with a call to `library()`

```{r}
library(ggplot2)
ggplot(cars)
```
Every ggplot needs at least 3 things:
1. the **data** ie stuff to plot as a data.fra,e
2. the **aes** or aesthetics thaat map the data to the plot
3. the **geom_** or geometry ie the plot type such as points, lines etc.

```{r}
ggplot(data=cars)+
  aes(x=speed,y=dist)+
  geom_smooth(method="lm", sep=FALSE)+
  geom_point()+
  labs(x="Speed (MPH)", y="Distance (ft)",title="cars")
```




## Gene Expression Plot
Read some data on the effects of GLP-1 inhibitor (drug) on exprsesion values

```{r}
url <- "https://bioboot.github.io/bimm143_S20/class-material/up_down_expression.txt"
genes <- read.delim(url)
head(genes)
nrow(genes)
ncol(genes)

```

```{r}
ggplot(genes)+
  aes(x=Condition1, y=Condition2)+
  geom_point(col="darkblue", alpha=0.3)
```



Let's color by `state` up, down or no change

```{r}
head(genes$State)
table(genes$State)
table(genes$State)/sum(table(genes$State))


```


```{r}
ggplot(genes)+
  aes(x=Condition1, y=Condition2, col=State)+
  geom_point()+
  scale_colour_manual( values=c("down"="blue","unchanging"="gray","up"="red") )+
  labs(x="Control (no drug)",y="Drug",title="DEG with GLP-1 drug")
```


## Going further with gapmider

Here we explore the famous `gapminder` dataset with some custom plots.



```{r}
url <- "https://raw.githubusercontent.com/jennybc/gapminder/master/inst/extdata/gapminder.tsv"

gapminder <- read.delim(url)

head(gapminder)
```

> Q. How many rows?

```{r}
nrow(gapminder)
```


>Q how many countinents?

```{r}
length(table(gapminder$continent))
length(unique(gapminder$continent))
```



Version 1 plot: gdpPercap vs lifeExp for all rows

```{r}
ggplot(gapminder, aes(gdpPercap,lifeExp, col=continent))+
  geom_point(alpha=0.5)+
  theme_minimal()+
  scale_colour_manual( values=c("Asia"="blue","Europe"="darkgreen","Africa"="red","Americas"="orange","Oceania"="green") )

  
```

I want to see a plot for each continent - in ggplot lingo this is called "faceting"
```{r}
ggplot(gapminder, aes(gdpPercap,lifeExp, col=continent))+
  geom_point(alpha=0.5)+
  theme_minimal()+
  scale_colour_manual( values=c("Asia"="blue","Europe"="darkgreen","Africa"="red","Americas"="orange","Oceania"="green") )+
  facet_wrap(~continent)

  
```


## First look at the `dplyr` package
Another add-on package with a function called `filter()` that we want to use.


```{r}
library(dplyr)

sub_gap<-gapminder %>%
  filter(year==2007, country=="Ireland")
sub_gap

```

```{r}
gap_sub<-filter(gapminder, year==2007|year==1977)

ggplot(gap_sub,aes(gdpPercap,lifeExp, col=continent))+
  geom_point(alpha=0.5)+
  theme_minimal()+
  facet_wrap(~year)
```




